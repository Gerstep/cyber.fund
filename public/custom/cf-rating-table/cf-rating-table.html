<link rel="import" href="/components/polymer/polymer.html">
<link rel="import" href="/components/core-selector/core-selector.html">
<link rel="import" href="/components/core-list/core-list.html">
<link rel="import" href="/components/core-image/core-image.html">
<link rel="import" href="/components/paper-item/paper-item.html">
<link rel="import" href="/components/star-rate/star-rate.html">
<link rel="import" href="/components/paper-button/paper-button.html">
<link rel="import" href="/components/meteor/meteor-collection.html">
<link rel="import" href="/components/meteor/meteor-subscribe.html">
<link rel="import" href="/components/meteor/meteor-query.html">
<link rel="import" href="/custom/cf-readable-supply/cf-readable-supply.html">
<link rel="import" href="/custom/cf-readable-trade-volume/cf-readable-trade-volume.html">
<link rel="import" href="/custom/cf-colorful-percents/cf-colorful-percents.html">

<polymer-element name="cf-rating-table" vertical layout>
	<template>
		<meteor-collection name="CurrentData" ref="{{collection}}"></meteor-collection>
		<meteor-subscribe name="current-data"></meteor-subscribe>
		<meteor-query collection="{{collection}}" options="{{options}}" data="{{current}}"></meteor-query>

		<div horizontal layout style="padding: 0.9em 1em">
			<b flex></b>
			<b flex two>System</b>
			<b flex>Rating</b>
			<b flex>Supply</b>
			<b flex>Trade Volume</b>
			<b flex>Bitcoin Cap</b>
			<b flex>Change</b>
			<b flex>USD Cap</b>
			<b flex>Change</b>
		</div>

		<core-list data="{{current}}" id="list" flex>
			<template>
				<paper-item id="{{model._id}}">
					<div flex horizontal center layout>
						<span flex>
							<core-image
								style="width: 30px; height: 30px"
								sizing="contain"
								src="http://cyber.fund/logos/{{(model.name ? model.name : '') | lowercase}}.png"
							></core-image>
						</span>
						<span flex two>{{model.name}}</span>
						<star-rate value="{{model.rating}}" readOnly flex></star-rate>
						<cf-readable-supply
							percents="{{model.supplyChangePercents.week}}"
							change="{{model.supplyChange.week}}"
							absolute="{{model.supply}}"
							flex
						></cf-readable-supply>
						<cf-readable-trade-volume
							deviation="{{model.tradeVolumeMedianDeviation.week}}"
							absolute="{{model.tradeVolume}}"
							flex
						></cf-readable-trade-volume>
						<span flex>{{model.cap.btc | round(2)}} BTC</span>
						<cf-colorful-percents
							percents="{{model.capChangePercents.week.btc}}"
							change="{{model.capChange.week.btc}}"
							flex
						></cf-colorful-percents>
						<span flex>${{model.cap.usd | round(2)}}</span>
						<cf-colorful-percents
							percents="{{model.capChangePercents.week.usd}}"
							change="{{model.capChange.week.usd}}"
							flex
						></cf-colorful-percents>
					</div>
				</paper-item>
			</template>
		</core-list>
	</template>

	<script>
		Polymer('cf-rating-table');
	</script>
</polymer-element>
